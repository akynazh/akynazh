<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <link rel="preload" href="/%20lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2"
    crossorigin="anonymous">
  <link rel="preload" href="/%20lib/font-awesome/webfonts/fa-regular-400.woff2" as="font"
    type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/%20lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2"
    crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Python自动爬取花瓣网任意面板中所有图片 | Norwegian Wood</title>
  <link rel='canonical' href='/posts/2020/02/python-automatically-crawls-all-pictures-in-any-panel-of-petal-net/'>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Python自动爬取花瓣网任意面板中所有图片" />
<meta property="og:description" content="注：该项目只适用于旧版花瓣，但其中的思路值得领会。对于新版花瓣编写的代码，逻辑差别不大。
需要安装的库  urllib easygui selenium webdriver_manager  获取过程  进入面板内 复制当前面板url 启动该脚本按提示进行即可  代码编写流程 分析pin图特点 查看面板源码，可以在对应的script中找到面板中图片的json数据。
在app.page[&ldquo;board&rdquo;]下可以找到&quot;pins&quot;:[{&hellip;}]，主要图片ID(pin)位于这里面。
获取到图片的ID(pin)之后可以对应访问点击图片后进入的地址http://huaban.com/pins/pinId/，并获取页面源码：
显然可见主要图片的源码特征，书写对应正则表达式可以获取图片真实地址。
分析滚动特点 通过滚动页面我们可以发现加载规律：
原来的图片对应的代码：
经过滚动，原来的代码逐渐被一些新的代码取代：
而不难发现他们都有对应的data-id!而data-id就是图片地址中对应的pin。
所以我们可以通过webdriver滚动加载页面，每滚动一次就进行一次data-id的读取，并利用集合进行去重即可。
具体实现 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125  # 花瓣用户任意面板图片爬取 import urllib." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2020/02/python-automatically-crawls-all-pictures-in-any-panel-of-petal-net/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-13T00:14:23+08:00" />
<meta property="article:modified_time" content="2020-02-13T00:14:23+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python自动爬取花瓣网任意面板中所有图片"/>
<meta name="twitter:description" content="注：该项目只适用于旧版花瓣，但其中的思路值得领会。对于新版花瓣编写的代码，逻辑差别不大。
需要安装的库  urllib easygui selenium webdriver_manager  获取过程  进入面板内 复制当前面板url 启动该脚本按提示进行即可  代码编写流程 分析pin图特点 查看面板源码，可以在对应的script中找到面板中图片的json数据。
在app.page[&ldquo;board&rdquo;]下可以找到&quot;pins&quot;:[{&hellip;}]，主要图片ID(pin)位于这里面。
获取到图片的ID(pin)之后可以对应访问点击图片后进入的地址http://huaban.com/pins/pinId/，并获取页面源码：
显然可见主要图片的源码特征，书写对应正则表达式可以获取图片真实地址。
分析滚动特点 通过滚动页面我们可以发现加载规律：
原来的图片对应的代码：
经过滚动，原来的代码逐渐被一些新的代码取代：
而不难发现他们都有对应的data-id!而data-id就是图片地址中对应的pin。
所以我们可以通过webdriver滚动加载页面，每滚动一次就进行一次data-id的读取，并利用集合进行去重即可。
具体实现 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125  # 花瓣用户任意面板图片爬取 import urllib."/>

  
  
  
  
  
  <link rel="stylesheet" href="/css/styles.09f1de3a03a3185b1f1da4e352b3004aab5d2e95ce7125b390aef821855b3a31dee8a069d9f31fd2757a73e8b339e20a5d0785f1e4cf04aa84db9b45ee386a4b.css" integrity="sha512-CfHeOgOjGFsfHaTjUrMASqtdLpXOcSWzkK74IYVbOjHe6KBp2fMf0nV6c&#43;izOeIKXQeF8eTPBKqE25tF7jhqSw==">

  
  
  <link rel="stylesheet" href="css/my.css"> 
  
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="image/base/favicon.ico" />

  
  
  
  
</head>
<body class="max-width-blog mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Archives</a></li>
         
        <li><a href="/gallery">Gallery</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" /posts/2020/02/basic-usage-sorting-of-matlab/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="/posts/2020/07/some-algorithms-about-prime-numbers/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&text=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&title=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&is_video=false&description=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87&body=Check out this article: %2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&title=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&title=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&name=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87&description=%e6%b3%a8%ef%bc%9a%e8%af%a5%e9%a1%b9%e7%9b%ae%e5%8f%aa%e9%80%82%e7%94%a8%e4%ba%8e%e6%97%a7%e7%89%88%e8%8a%b1%e7%93%a3%ef%bc%8c%e4%bd%86%e5%85%b6%e4%b8%ad%e7%9a%84%e6%80%9d%e8%b7%af%e5%80%bc%e5%be%97%e9%a2%86%e4%bc%9a%e3%80%82%e5%af%b9%e4%ba%8e%e6%96%b0%e7%89%88%e8%8a%b1%e7%93%a3%e7%bc%96%e5%86%99%e7%9a%84%e4%bb%a3%e7%a0%81%ef%bc%8c%e9%80%bb%e8%be%91%e5%b7%ae%e5%88%ab%e4%b8%8d%e5%a4%a7%e3%80%82%0a%e9%9c%80%e8%a6%81%e5%ae%89%e8%a3%85%e7%9a%84%e5%ba%93%20%20urllib%20easygui%20selenium%20webdriver_manager%20%20%e8%8e%b7%e5%8f%96%e8%bf%87%e7%a8%8b%20%20%e8%bf%9b%e5%85%a5%e9%9d%a2%e6%9d%bf%e5%86%85%20%e5%a4%8d%e5%88%b6%e5%bd%93%e5%89%8d%e9%9d%a2%e6%9d%bfurl%20%e5%90%af%e5%8a%a8%e8%af%a5%e8%84%9a%e6%9c%ac%e6%8c%89%e6%8f%90%e7%a4%ba%e8%bf%9b%e8%a1%8c%e5%8d%b3%e5%8f%af%20%20%e4%bb%a3%e7%a0%81%e7%bc%96%e5%86%99%e6%b5%81%e7%a8%8b%20%e5%88%86%e6%9e%90pin%e5%9b%be%e7%89%b9%e7%82%b9%20%e6%9f%a5%e7%9c%8b%e9%9d%a2%e6%9d%bf%e6%ba%90%e7%a0%81%ef%bc%8c%e5%8f%af%e4%bb%a5%e5%9c%a8%e5%af%b9%e5%ba%94%e7%9a%84script%e4%b8%ad%e6%89%be%e5%88%b0%e9%9d%a2%e6%9d%bf%e4%b8%ad%e5%9b%be%e7%89%87%e7%9a%84json%e6%95%b0%e6%8d%ae%e3%80%82%0a%e5%9c%a8app.page%5b%26ldquo%3bboard%26rdquo%3b%5d%e4%b8%8b%e5%8f%af%e4%bb%a5%e6%89%be%e5%88%b0%26quot%3bpins%26quot%3b%3a%5b%7b%26hellip%3b%7d%5d%ef%bc%8c%e4%b8%bb%e8%a6%81%e5%9b%be%e7%89%87ID%28pin%29%e4%bd%8d%e4%ba%8e%e8%bf%99%e9%87%8c%e9%9d%a2%e3%80%82%0a%e8%8e%b7%e5%8f%96%e5%88%b0%e5%9b%be%e7%89%87%e7%9a%84ID%28pin%29%e4%b9%8b%e5%90%8e%e5%8f%af%e4%bb%a5%e5%af%b9%e5%ba%94%e8%ae%bf%e9%97%ae%e7%82%b9%e5%87%bb%e5%9b%be%e7%89%87%e5%90%8e%e8%bf%9b%e5%85%a5%e7%9a%84%e5%9c%b0%e5%9d%80http%3a%2f%2fhuaban.com%2fpins%2fpinId%2f%ef%bc%8c%e5%b9%b6%e8%8e%b7%e5%8f%96%e9%a1%b5%e9%9d%a2%e6%ba%90%e7%a0%81%ef%bc%9a%0a%e6%98%be%e7%84%b6%e5%8f%af%e8%a7%81%e4%b8%bb%e8%a6%81%e5%9b%be%e7%89%87%e7%9a%84%e6%ba%90%e7%a0%81%e7%89%b9%e5%be%81%ef%bc%8c%e4%b9%a6%e5%86%99%e5%af%b9%e5%ba%94%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f%e5%8f%af%e4%bb%a5%e8%8e%b7%e5%8f%96%e5%9b%be%e7%89%87%e7%9c%9f%e5%ae%9e%e5%9c%b0%e5%9d%80%e3%80%82%0a%e5%88%86%e6%9e%90%e6%bb%9a%e5%8a%a8%e7%89%b9%e7%82%b9%20%e9%80%9a%e8%bf%87%e6%bb%9a%e5%8a%a8%e9%a1%b5%e9%9d%a2%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e5%8f%91%e7%8e%b0%e5%8a%a0%e8%bd%bd%e8%a7%84%e5%be%8b%ef%bc%9a%0a%e5%8e%9f%e6%9d%a5%e7%9a%84%e5%9b%be%e7%89%87%e5%af%b9%e5%ba%94%e7%9a%84%e4%bb%a3%e7%a0%81%ef%bc%9a%0a%e7%bb%8f%e8%bf%87%e6%bb%9a%e5%8a%a8%ef%bc%8c%e5%8e%9f%e6%9d%a5%e7%9a%84%e4%bb%a3%e7%a0%81%e9%80%90%e6%b8%90%e8%a2%ab%e4%b8%80%e4%ba%9b%e6%96%b0%e7%9a%84%e4%bb%a3%e7%a0%81%e5%8f%96%e4%bb%a3%ef%bc%9a%0a%e8%80%8c%e4%b8%8d%e9%9a%be%e5%8f%91%e7%8e%b0%e4%bb%96%e4%bb%ac%e9%83%bd%e6%9c%89%e5%af%b9%e5%ba%94%e7%9a%84data-id%21%e8%80%8cdata-id%e5%b0%b1%e6%98%af%e5%9b%be%e7%89%87%e5%9c%b0%e5%9d%80%e4%b8%ad%e5%af%b9%e5%ba%94%e7%9a%84pin%e3%80%82%0a%e6%89%80%e4%bb%a5%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e9%80%9a%e8%bf%87webdriver%e6%bb%9a%e5%8a%a8%e5%8a%a0%e8%bd%bd%e9%a1%b5%e9%9d%a2%ef%bc%8c%e6%af%8f%e6%bb%9a%e5%8a%a8%e4%b8%80%e6%ac%a1%e5%b0%b1%e8%bf%9b%e8%a1%8c%e4%b8%80%e6%ac%a1data-id%e7%9a%84%e8%af%bb%e5%8f%96%ef%bc%8c%e5%b9%b6%e5%88%a9%e7%94%a8%e9%9b%86%e5%90%88%e8%bf%9b%e8%a1%8c%e5%8e%bb%e9%87%8d%e5%8d%b3%e5%8f%af%e3%80%82%0a%e5%85%b7%e4%bd%93%e5%ae%9e%e7%8e%b0%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%2014%2015%2016%2017%2018%2019%2020%2021%2022%2023%2024%2025%2026%2027%2028%2029%2030%2031%2032%2033%2034%2035%2036%2037%2038%2039%2040%2041%2042%2043%2044%2045%2046%2047%2048%2049%2050%2051%2052%2053%2054%2055%2056%2057%2058%2059%2060%2061%2062%2063%2064%2065%2066%2067%2068%2069%2070%2071%2072%2073%2074%2075%2076%2077%2078%2079%2080%2081%2082%2083%2084%2085%2086%2087%2088%2089%2090%2091%2092%2093%2094%2095%2096%2097%2098%2099%20100%20101%20102%20103%20104%20105%20106%20107%20108%20109%20110%20111%20112%20113%20114%20115%20116%20117%20118%20119%20120%20121%20122%20123%20124%20125%20%20%23%20%e8%8a%b1%e7%93%a3%e7%94%a8%e6%88%b7%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e5%9b%be%e7%89%87%e7%88%ac%e5%8f%96%20import%20urllib." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&t=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#需要安装的库">需要安装的库</a></li>
    <li><a href="#获取过程">获取过程</a></li>
    <li><a href="#代码编写流程">代码编写流程</a>
      <ul>
        <li><a href="#分析pin图特点">分析pin图特点</a></li>
        <li><a href="#分析滚动特点">分析滚动特点</a></li>
        <li><a href="#具体实现">具体实现</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
  </span>
</div>

  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Python自动爬取花瓣网任意面板中所有图片
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-02-13 00:14:23 &#43;0800 CST" itemprop="datePublished">2020-02-13</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          7 minute read
        </div>
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/code">Code</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/python" rel="tag">python</a>
            
             ,  
            <a class="tag-link" href="/tags/web" rel="tag">web</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <p>注：该项目只适用于旧版花瓣，但其中的思路值得领会。对于新版花瓣编写的代码，逻辑差别不大。</p>
<h2 id="需要安装的库">需要安装的库</h2>
<ul>
<li>urllib</li>
<li>easygui</li>
<li>selenium</li>
<li>webdriver_manager</li>
</ul>
<h2 id="获取过程">获取过程</h2>
<ol>
<li>进入面板内</li>
<li>复制当前面板url</li>
<li>启动该脚本按提示进行即可</li>
</ol>
<h2 id="代码编写流程">代码编写流程</h2>
<h3 id="分析pin图特点">分析pin图特点</h3>
<p>查看面板源码，可以在对应的script中找到面板中图片的json数据。</p>
<p>在app.page[&ldquo;board&rdquo;]下可以找到&quot;pins&quot;:[{&hellip;}]，主要图片ID(pin)位于这里面。</p>
<p><img src="/image/python-automatically-crawls-all-pictures-in-any-panel-of-petal-net/1.png" alt=""></p>
<p>获取到图片的ID(pin)之后可以对应访问点击图片后进入的地址http://huaban.com/pins/pinId/，并获取页面源码：</p>
<p><img src="/image/python-automatically-crawls-all-pictures-in-any-panel-of-petal-net/2.png" alt=""></p>
<p>显然可见主要图片的源码特征，书写对应正则表达式可以获取图片真实地址。</p>
<h3 id="分析滚动特点">分析滚动特点</h3>
<p>通过滚动页面我们可以发现<strong>加载规律</strong>：</p>
<p>原来的图片对应的代码：</p>
<p><img src="/image/python-automatically-crawls-all-pictures-in-any-panel-of-petal-net/3.png" alt=""></p>
<p>经过滚动，原来的代码逐渐被一些新的代码取代：</p>
<p><img src="/image/python-automatically-crawls-all-pictures-in-any-panel-of-petal-net/4.png" alt=""></p>
<p>而不难发现他们都有对应的<strong>data-id</strong>!而data-id就是图片地址中对应的<strong>pin</strong>。</p>
<p>所以我们可以通过<strong>webdriver滚动加载页面</strong>，<strong>每滚动一次就进行一次data-id的读取</strong>，并利用<strong>集合进行去重</strong>即可。</p>
<h3 id="具体实现">具体实现</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6272a4"># 花瓣用户任意面板图片爬取</span>
<span style="color:#ff79c6">import</span> urllib.request
<span style="color:#ff79c6">import</span> urllib.error
<span style="color:#ff79c6">import</span> re
<span style="color:#ff79c6">import</span> os
<span style="color:#ff79c6">import</span> datetime
<span style="color:#ff79c6">import</span> easygui
<span style="color:#ff79c6">import</span> time
<span style="color:#ff79c6">from</span> selenium <span style="color:#ff79c6">import</span> webdriver
<span style="color:#ff79c6">from</span> selenium.webdriver.chrome.service <span style="color:#ff79c6">import</span> Service
<span style="color:#ff79c6">from</span> selenium.webdriver.common <span style="color:#ff79c6">import</span> service
<span style="color:#ff79c6">from</span> webdriver_manager <span style="color:#ff79c6">import</span> driver
<span style="color:#ff79c6">from</span> webdriver_manager.chrome <span style="color:#ff79c6">import</span> ChromeDriverManager
<span style="color:#ff79c6">import</span> winsound

<span style="color:#6272a4"># 获取网页中所有图片对应的pin</span>
<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_pins</span>(url_, num_):
    my_options <span style="color:#ff79c6">=</span> webdriver<span style="color:#ff79c6">.</span>ChromeOptions()
    my_options<span style="color:#ff79c6">.</span>add_argument(<span style="color:#f1fa8c">&#34;start-maximized&#34;</span>)
    my_options<span style="color:#ff79c6">.</span>add_argument(<span style="color:#f1fa8c">&#34;--ignore-certificate-errors&#34;</span>)
    my_options<span style="color:#ff79c6">.</span>add_argument(<span style="color:#f1fa8c">&#34;--ignore-ssl-errors&#34;</span>)
    my_options<span style="color:#ff79c6">.</span>add_experimental_option(<span style="color:#f1fa8c">&#34;excludeSwitches&#34;</span>, [<span style="color:#f1fa8c">&#39;enable-automation&#39;</span>, <span style="color:#f1fa8c">&#39;enable-logging&#39;</span>])
    driver <span style="color:#ff79c6">=</span> webdriver<span style="color:#ff79c6">.</span>Chrome(service<span style="color:#ff79c6">=</span>Service(ChromeDriverManager()<span style="color:#ff79c6">.</span>install()), options<span style="color:#ff79c6">=</span>my_options)
    <span style="color:#6272a4"># 如果当前chromedriver版本不对，会自动去官网下载对应的版本到~/.wdm/drivers/chromedriver里，且会有缓存，下次直接读取缓存</span>
    driver<span style="color:#ff79c6">.</span>get(url_)

    js <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;window.scrollTo(0,document.body.scrollHeight);&#34;</span> <span style="color:#6272a4"># js脚本实现向下滑动</span>
    pattern <span style="color:#ff79c6">=</span> re<span style="color:#ff79c6">.</span>compile(<span style="color:#f1fa8c">r</span><span style="color:#f1fa8c">&#39;data-id=?&#34;(\d*)&#34;&#39;</span>)
    pins_ <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">set</span>()
    <span style="color:#6272a4"># 可以使用大括号 { } 或者 set() 函数创建集合，但是注意如果创建一个空集合必须用 set() 而不是 { }，因为{}是用来表示空字典类型的。</span>
    num <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(num_)
    tries <span style="color:#ff79c6">=</span> num <span style="color:#ff79c6">/</span> <span style="color:#bd93f9">15</span> <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>; <span style="color:#6272a4"># 滑动次数，每次滑动大约可以获得15张图片的pin</span>
    <span style="color:#ff79c6">while</span> <span style="color:#ff79c6">True</span>:
        tries <span style="color:#ff79c6">-=</span> <span style="color:#bd93f9">1</span>
        html_ <span style="color:#ff79c6">=</span> driver<span style="color:#ff79c6">.</span>page_source
        pins_1 <span style="color:#ff79c6">=</span> re<span style="color:#ff79c6">.</span>findall(pattern, html_) <span style="color:#6272a4"># 返回获取到的pin列表</span>
        pins_2 <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">set</span>(pins_1) <span style="color:#6272a4"># pin列表转化为pin集合</span>
        pins_<span style="color:#ff79c6">.</span>update(pins_2) <span style="color:#6272a4"># 求交集，以免下载重复照片</span>
        driver<span style="color:#ff79c6">.</span>execute_script(js)
        time<span style="color:#ff79c6">.</span>sleep(<span style="color:#bd93f9">1</span>) <span style="color:#6272a4"># 给脚本运行留足时间</span>
        <span style="color:#ff79c6">if</span> tries <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">0</span>:
            <span style="color:#ff79c6">break</span>
    driver<span style="color:#ff79c6">.</span>close()
    <span style="color:#ff79c6">return</span> pins_


<span style="color:#6272a4"># 获取页面html</span>
<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_html_1</span>(url_):
    <span style="color:#ff79c6">try</span>:
        page <span style="color:#ff79c6">=</span> urllib<span style="color:#ff79c6">.</span>request<span style="color:#ff79c6">.</span>urlopen(url_)
    <span style="color:#ff79c6">except</span> urllib<span style="color:#ff79c6">.</span>error<span style="color:#ff79c6">.</span>URLError:
        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;fail&#39;</span>
    html_ <span style="color:#ff79c6">=</span> page<span style="color:#ff79c6">.</span>read()<span style="color:#ff79c6">.</span>decode(<span style="color:#f1fa8c">&#39;utf-8&#39;</span>)
    <span style="color:#ff79c6">return</span> html_


<span style="color:#6272a4"># 下载图片</span>
<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">get_image</span>(path_, pin_list):
    success <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
    fail <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
    now <span style="color:#ff79c6">=</span> time<span style="color:#ff79c6">.</span>time()
    t_now <span style="color:#ff79c6">=</span> time<span style="color:#ff79c6">.</span>strftime(<span style="color:#f1fa8c">&#34;%Y-%m-</span><span style="color:#f1fa8c">%d</span><span style="color:#f1fa8c">_%H-%M-%S_&#34;</span>, time<span style="color:#ff79c6">.</span>localtime(now))
    <span style="color:#ff79c6">for</span> pinId <span style="color:#ff79c6">in</span> pin_list:
        <span style="color:#6272a4"># 获取跳转网页网址</span>
        url_str <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">r</span><span style="color:#f1fa8c">&#39;http://huaban.com/pins/</span><span style="color:#f1fa8c">%s</span><span style="color:#f1fa8c">/&#39;</span> <span style="color:#ff79c6">%</span> pinId

        <span style="color:#6272a4"># 获取点击图片时弹出网页的源码</span>
        pinId_source <span style="color:#ff79c6">=</span> get_html_1(url_str)
        <span style="color:#ff79c6">if</span> pinId_source <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;fail&#39;</span>:
            <span style="color:#ff79c6">continue</span>

        <span style="color:#6272a4"># 解析源码，获取原图片的网址</span>
        <span style="color:#f1fa8c">&#39;&#39;&#39;
</span><span style="color:#f1fa8c">        &lt;div class=&#34;main-image&#34;&gt;&lt;div class=&#34;image-holder&#34; id=&#34;baidu_image_holder&#34;&gt;
</span><span style="color:#f1fa8c">        &lt;img src=&#34;//hbimg.huabanimg.com/64369267b9c8dc7a43da81457658c05b1a752f9329ec0-dSfdfl_fw658/format/webp&#34;
</span><span style="color:#f1fa8c">        &#39;&#39;&#39;</span>
        img_url_re <span style="color:#ff79c6">=</span> re<span style="color:#ff79c6">.</span>compile(<span style="color:#f1fa8c">&#39;main-image.*?src=&#34;(.*?)&#34;&#39;</span>, re<span style="color:#ff79c6">.</span>S)
        img_url_list <span style="color:#ff79c6">=</span> re<span style="color:#ff79c6">.</span>findall(img_url_re, pinId_source)
        img_url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;http:&#39;</span> <span style="color:#ff79c6">+</span> img_url_list[<span style="color:#bd93f9">0</span>]
        <span style="color:#ff79c6">try</span>:
            urllib<span style="color:#ff79c6">.</span>request<span style="color:#ff79c6">.</span>urlretrieve(img_url, path_ <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\\</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">+</span> t_now <span style="color:#ff79c6">+</span> <span style="color:#8be9fd;font-style:italic">str</span>(success) <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;.jpg&#34;</span>)
            <span style="color:#6272a4"># urlretrieve()方法直接将远程数据下载到本地</span>
        <span style="color:#ff79c6">except</span> urllib<span style="color:#ff79c6">.</span>error<span style="color:#ff79c6">.</span>URLError:
            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;获取失败！</span><span style="color:#f1fa8c">%s</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">%</span> img_url)
            fail <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">1</span>
            <span style="color:#ff79c6">continue</span>
        <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;获取成功！</span><span style="color:#f1fa8c">%s</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">%</span> img_url)
        success <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">1</span>
    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;成功获取图片张数：</span><span style="color:#f1fa8c">%d</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">%</span>success)
    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;获取失败的图片张数：</span><span style="color:#f1fa8c">%d</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">%</span>fail)
    winsound<span style="color:#ff79c6">.</span>Beep(frequency<span style="color:#ff79c6">=</span><span style="color:#bd93f9">250</span>, duration<span style="color:#ff79c6">=</span><span style="color:#bd93f9">500</span>)
    os<span style="color:#ff79c6">.</span>system(<span style="color:#f1fa8c">&#34;pause&#34;</span>)


<span style="color:#6272a4"># 创建文件夹路径</span>
<span style="color:#ff79c6">def</span> <span style="color:#50fa7b">createPath</span>():
    <span style="color:#ff79c6">while</span> <span style="color:#ff79c6">True</span>:
        path_ <span style="color:#ff79c6">=</span> easygui<span style="color:#ff79c6">.</span>diropenbox(title<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;选择你要保存的路径&#39;</span>)
        filePath <span style="color:#ff79c6">=</span> path_ <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\\</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">+</span> <span style="color:#8be9fd;font-style:italic">str</span>(datetime<span style="color:#ff79c6">.</span>datetime<span style="color:#ff79c6">.</span>now()<span style="color:#ff79c6">.</span>strftime(<span style="color:#f1fa8c">&#39;%Y-%m-</span><span style="color:#f1fa8c">%d</span><span style="color:#f1fa8c"> %H.%M.%S&#39;</span>))

        isExists <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>exists(filePath)
        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> isExists:
            <span style="color:#6272a4"># 创建目录</span>
            os<span style="color:#ff79c6">.</span>makedirs(filePath)
            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">%s</span><span style="color:#f1fa8c">创建成功！&#39;</span> <span style="color:#ff79c6">%</span> filePath)
            <span style="color:#ff79c6">break</span>
        <span style="color:#ff79c6">else</span>:
            <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">%s</span><span style="color:#f1fa8c">已存在重新输入！&#39;</span> <span style="color:#ff79c6">%</span> filePath)
    <span style="color:#ff79c6">return</span> filePath


<span style="color:#ff79c6">if</span> __name__ <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;__main__&#39;</span>:
    <span style="color:#6272a4"># 用户输入数据</span>
    values <span style="color:#ff79c6">=</span> easygui<span style="color:#ff79c6">.</span>multenterbox(<span style="color:#f1fa8c">&#34;获取花瓣用户任意面板中的图片&#34;</span>, <span style="color:#f1fa8c">&#34;welcome&#34;</span>, [<span style="color:#f1fa8c">&#34;面板的地址&#34;</span>, <span style="color:#f1fa8c">&#34;想下载的大概张数&#34;</span>])
    url <span style="color:#ff79c6">=</span> values[<span style="color:#bd93f9">0</span>]
    num <span style="color:#ff79c6">=</span> values[<span style="color:#bd93f9">1</span>]
    path <span style="color:#ff79c6">=</span> createPath()

    <span style="color:#6272a4"># 获取图片的pin</span>
    pins <span style="color:#ff79c6">=</span> get_pins(url, num)

    <span style="color:#6272a4"># 获取并下载图片</span>
    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#39;即将为主人下载</span><span style="color:#f1fa8c">%d</span><span style="color:#f1fa8c">张照片~&#39;</span> <span style="color:#ff79c6">%</span><span style="color:#8be9fd;font-style:italic">len</span>(pins))
    get_image(path, pins)

</code></pre></td></tr></table>
</div>
</div><hr>
<p><strong>From My Blog: <a href="https://akynazh.site">akynazh</a></strong>.</p>
<p><strong>Over.</strong></p>

    </div>
  </article>

  
  




  <div class="blog-post-comments">
    
      <div id="disquss_thread">
  <script src="https://utteranc.es/client.js"
    repo="akynazh/hugo-comment"
    issue-term="pathname"
    label="akynazh"
    theme="github-dark"
    crossorigin="anonymous"
    async>
  </script>
</div>
    
  </div>



  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Archives</a></li>
         
          <li><a href="/gallery">Gallery</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#需要安装的库">需要安装的库</a></li>
    <li><a href="#获取过程">获取过程</a></li>
    <li><a href="#代码编写流程">代码编写流程</a>
      <ul>
        <li><a href="#分析pin图特点">分析pin图特点</a></li>
        <li><a href="#分析滚动特点">分析滚动特点</a></li>
        <li><a href="#具体实现">具体实现</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&text=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&title=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&is_video=false&description=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87&body=Check out this article: %2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&title=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&title=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&name=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87&description=%e6%b3%a8%ef%bc%9a%e8%af%a5%e9%a1%b9%e7%9b%ae%e5%8f%aa%e9%80%82%e7%94%a8%e4%ba%8e%e6%97%a7%e7%89%88%e8%8a%b1%e7%93%a3%ef%bc%8c%e4%bd%86%e5%85%b6%e4%b8%ad%e7%9a%84%e6%80%9d%e8%b7%af%e5%80%bc%e5%be%97%e9%a2%86%e4%bc%9a%e3%80%82%e5%af%b9%e4%ba%8e%e6%96%b0%e7%89%88%e8%8a%b1%e7%93%a3%e7%bc%96%e5%86%99%e7%9a%84%e4%bb%a3%e7%a0%81%ef%bc%8c%e9%80%bb%e8%be%91%e5%b7%ae%e5%88%ab%e4%b8%8d%e5%a4%a7%e3%80%82%0a%e9%9c%80%e8%a6%81%e5%ae%89%e8%a3%85%e7%9a%84%e5%ba%93%20%20urllib%20easygui%20selenium%20webdriver_manager%20%20%e8%8e%b7%e5%8f%96%e8%bf%87%e7%a8%8b%20%20%e8%bf%9b%e5%85%a5%e9%9d%a2%e6%9d%bf%e5%86%85%20%e5%a4%8d%e5%88%b6%e5%bd%93%e5%89%8d%e9%9d%a2%e6%9d%bfurl%20%e5%90%af%e5%8a%a8%e8%af%a5%e8%84%9a%e6%9c%ac%e6%8c%89%e6%8f%90%e7%a4%ba%e8%bf%9b%e8%a1%8c%e5%8d%b3%e5%8f%af%20%20%e4%bb%a3%e7%a0%81%e7%bc%96%e5%86%99%e6%b5%81%e7%a8%8b%20%e5%88%86%e6%9e%90pin%e5%9b%be%e7%89%b9%e7%82%b9%20%e6%9f%a5%e7%9c%8b%e9%9d%a2%e6%9d%bf%e6%ba%90%e7%a0%81%ef%bc%8c%e5%8f%af%e4%bb%a5%e5%9c%a8%e5%af%b9%e5%ba%94%e7%9a%84script%e4%b8%ad%e6%89%be%e5%88%b0%e9%9d%a2%e6%9d%bf%e4%b8%ad%e5%9b%be%e7%89%87%e7%9a%84json%e6%95%b0%e6%8d%ae%e3%80%82%0a%e5%9c%a8app.page%5b%26ldquo%3bboard%26rdquo%3b%5d%e4%b8%8b%e5%8f%af%e4%bb%a5%e6%89%be%e5%88%b0%26quot%3bpins%26quot%3b%3a%5b%7b%26hellip%3b%7d%5d%ef%bc%8c%e4%b8%bb%e8%a6%81%e5%9b%be%e7%89%87ID%28pin%29%e4%bd%8d%e4%ba%8e%e8%bf%99%e9%87%8c%e9%9d%a2%e3%80%82%0a%e8%8e%b7%e5%8f%96%e5%88%b0%e5%9b%be%e7%89%87%e7%9a%84ID%28pin%29%e4%b9%8b%e5%90%8e%e5%8f%af%e4%bb%a5%e5%af%b9%e5%ba%94%e8%ae%bf%e9%97%ae%e7%82%b9%e5%87%bb%e5%9b%be%e7%89%87%e5%90%8e%e8%bf%9b%e5%85%a5%e7%9a%84%e5%9c%b0%e5%9d%80http%3a%2f%2fhuaban.com%2fpins%2fpinId%2f%ef%bc%8c%e5%b9%b6%e8%8e%b7%e5%8f%96%e9%a1%b5%e9%9d%a2%e6%ba%90%e7%a0%81%ef%bc%9a%0a%e6%98%be%e7%84%b6%e5%8f%af%e8%a7%81%e4%b8%bb%e8%a6%81%e5%9b%be%e7%89%87%e7%9a%84%e6%ba%90%e7%a0%81%e7%89%b9%e5%be%81%ef%bc%8c%e4%b9%a6%e5%86%99%e5%af%b9%e5%ba%94%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f%e5%8f%af%e4%bb%a5%e8%8e%b7%e5%8f%96%e5%9b%be%e7%89%87%e7%9c%9f%e5%ae%9e%e5%9c%b0%e5%9d%80%e3%80%82%0a%e5%88%86%e6%9e%90%e6%bb%9a%e5%8a%a8%e7%89%b9%e7%82%b9%20%e9%80%9a%e8%bf%87%e6%bb%9a%e5%8a%a8%e9%a1%b5%e9%9d%a2%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e5%8f%91%e7%8e%b0%e5%8a%a0%e8%bd%bd%e8%a7%84%e5%be%8b%ef%bc%9a%0a%e5%8e%9f%e6%9d%a5%e7%9a%84%e5%9b%be%e7%89%87%e5%af%b9%e5%ba%94%e7%9a%84%e4%bb%a3%e7%a0%81%ef%bc%9a%0a%e7%bb%8f%e8%bf%87%e6%bb%9a%e5%8a%a8%ef%bc%8c%e5%8e%9f%e6%9d%a5%e7%9a%84%e4%bb%a3%e7%a0%81%e9%80%90%e6%b8%90%e8%a2%ab%e4%b8%80%e4%ba%9b%e6%96%b0%e7%9a%84%e4%bb%a3%e7%a0%81%e5%8f%96%e4%bb%a3%ef%bc%9a%0a%e8%80%8c%e4%b8%8d%e9%9a%be%e5%8f%91%e7%8e%b0%e4%bb%96%e4%bb%ac%e9%83%bd%e6%9c%89%e5%af%b9%e5%ba%94%e7%9a%84data-id%21%e8%80%8cdata-id%e5%b0%b1%e6%98%af%e5%9b%be%e7%89%87%e5%9c%b0%e5%9d%80%e4%b8%ad%e5%af%b9%e5%ba%94%e7%9a%84pin%e3%80%82%0a%e6%89%80%e4%bb%a5%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e9%80%9a%e8%bf%87webdriver%e6%bb%9a%e5%8a%a8%e5%8a%a0%e8%bd%bd%e9%a1%b5%e9%9d%a2%ef%bc%8c%e6%af%8f%e6%bb%9a%e5%8a%a8%e4%b8%80%e6%ac%a1%e5%b0%b1%e8%bf%9b%e8%a1%8c%e4%b8%80%e6%ac%a1data-id%e7%9a%84%e8%af%bb%e5%8f%96%ef%bc%8c%e5%b9%b6%e5%88%a9%e7%94%a8%e9%9b%86%e5%90%88%e8%bf%9b%e8%a1%8c%e5%8e%bb%e9%87%8d%e5%8d%b3%e5%8f%af%e3%80%82%0a%e5%85%b7%e4%bd%93%e5%ae%9e%e7%8e%b0%201%202%203%204%205%206%207%208%209%2010%2011%2012%2013%2014%2015%2016%2017%2018%2019%2020%2021%2022%2023%2024%2025%2026%2027%2028%2029%2030%2031%2032%2033%2034%2035%2036%2037%2038%2039%2040%2041%2042%2043%2044%2045%2046%2047%2048%2049%2050%2051%2052%2053%2054%2055%2056%2057%2058%2059%2060%2061%2062%2063%2064%2065%2066%2067%2068%2069%2070%2071%2072%2073%2074%2075%2076%2077%2078%2079%2080%2081%2082%2083%2084%2085%2086%2087%2088%2089%2090%2091%2092%2093%2094%2095%2096%2097%2098%2099%20100%20101%20102%20103%20104%20105%20106%20107%20108%20109%20110%20111%20112%20113%20114%20115%20116%20117%20118%20119%20120%20121%20122%20123%20124%20125%20%20%23%20%e8%8a%b1%e7%93%a3%e7%94%a8%e6%88%b7%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e5%9b%be%e7%89%87%e7%88%ac%e5%8f%96%20import%20urllib." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2f2020%2f02%2fpython-automatically-crawls-all-pictures-in-any-panel-of-petal-net%2f&t=Python%e8%87%aa%e5%8a%a8%e7%88%ac%e5%8f%96%e8%8a%b1%e7%93%a3%e7%bd%91%e4%bb%bb%e6%84%8f%e9%9d%a2%e6%9d%bf%e4%b8%ad%e6%89%80%e6%9c%89%e5%9b%be%e7%89%87" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  Jzh 
    | <a href='https://beian.miit.gov.cn/' style="text-decoration:none;">陕ICP备2022007986号-1</a>
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Archives</a></li>
         
        <li><a href="/gallery">Gallery</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/js/lazy.js></script>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
